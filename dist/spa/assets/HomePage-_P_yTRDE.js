import{Q as A,a as O,b as J,c as w}from"./QSkeleton-CaCHfAhN.js";import{r as g,c as u,h as b,P as W,g as X,R as Y,S as k,B as Z,l as ee,U as F,k as te,Q as ae,V as oe,d as se,o as le,G as ne,H as Q,O as re,I as _,W as n,X as y,L as ue,f,J as m,F as T,Y as j,Z as C}from"./index-B73IAH5T.js";import{b as ce,c as ie,a as de}from"./authStore-C-dgjd01.js";import{u as me,a as fe}from"./QInput-BAAJ7RLs.js";import{Q as ve}from"./QImg-Dv5RhQJC.js";import{u as ge,Q as pe}from"./comicStore-BsTTM-GS.js";import{c as q}from"./comicsService-CSb6vfZh.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-BKsCe8cw.js";import"./use-timeout-CEVp83Zx.js";function _e(s,t){const e=g(null),c=u(()=>s.disable===!0?null:b("span",{ref:e,class:"no-outline",tabindex:-1}));function i(r){const d=t.value;r?.qAvoidFocus!==!0&&(r?.type.indexOf("key")===0?document.activeElement!==d&&d?.contains(document.activeElement)===!0&&d.focus():e.value!==null&&(r===void 0||d?.contains(r.target)===!0)&&e.value.focus())}return{refocusTargetEl:c,refocusTarget:i}}const be={xs:30,sm:35,md:40,lg:50,xl:60},ke={...ce,...W,...me,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:s=>s==="tf"||s==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},ye=["update:modelValue"];function xe(s,t){const{props:e,slots:c,emit:i,proxy:r}=X(),{$q:d}=r,x=ie(e,d),p=g(null),{refocusTargetEl:o,refocusTarget:l}=_e(e,p),D=Y(e,be),V=u(()=>e.val!==void 0&&Array.isArray(e.modelValue)),S=u(()=>{const a=k(e.val);return V.value===!0?e.modelValue.findIndex(h=>k(h)===a):-1}),v=u(()=>V.value===!0?S.value!==-1:k(e.modelValue)===k(e.trueValue)),I=u(()=>V.value===!0?S.value===-1:k(e.modelValue)===k(e.falseValue)),$=u(()=>v.value===!1&&I.value===!1),E=u(()=>e.disable===!0?-1:e.tabindex||0),R=u(()=>`q-${s} cursor-pointer no-outline row inline no-wrap items-center`+(e.disable===!0?" disabled":"")+(x.value===!0?` q-${s}--dark`:"")+(e.dense===!0?` q-${s}--dense`:"")+(e.leftLabel===!0?" reverse":"")),U=u(()=>{const a=v.value===!0?"truthy":I.value===!0?"falsy":"indet",h=e.color!==void 0&&(e.keepColor===!0||v.value===!0)?` text-${e.color}`:"";return`q-${s}__inner relative-position non-selectable q-${s}__inner--${a}${h}`}),N=u(()=>{const a={type:"checkbox"};return e.name!==void 0&&Object.assign(a,{".checked":v.value,"^checked":v.value===!0?"checked":void 0,name:e.name,value:V.value===!0?e.val:e.trueValue}),a}),z=fe(N),L=u(()=>{const a={tabindex:E.value,role:"switch","aria-label":e.label,"aria-checked":$.value===!0?"mixed":v.value===!0?"true":"false"};return e.disable===!0&&(a["aria-disabled"]="true"),a});function P(a){a!==void 0&&(F(a),l(a)),e.disable!==!0&&i("update:modelValue",M(),a)}function M(){if(V.value===!0){if(v.value===!0){const a=e.modelValue.slice();return a.splice(S.value,1),a}return e.modelValue.concat([e.val])}if(v.value===!0){if(e.toggleOrder!=="ft"||e.toggleIndeterminate===!1)return e.falseValue}else if(I.value===!0){if(e.toggleOrder==="ft"||e.toggleIndeterminate===!1)return e.trueValue}else return e.toggleOrder!=="ft"?e.trueValue:e.falseValue;return e.indeterminateValue}function H(a){(a.keyCode===13||a.keyCode===32)&&F(a)}function K(a){(a.keyCode===13||a.keyCode===32)&&P(a)}const G=t(v,$);return Object.assign(r,{toggle:P}),()=>{const a=G();e.disable!==!0&&z(a,"unshift",` q-${s}__native absolute q-ma-none q-pa-none`);const h=[b("div",{class:U.value,style:D.value,"aria-hidden":"true"},a)];o.value!==null&&h.push(o.value);const B=e.label!==void 0?Z(c.default,[e.label]):ee(c.default);return B!==void 0&&h.push(b("div",{class:`q-${s}__label q-anchor--skip`},B)),b("div",{ref:p,class:R.value,...L.value,onClick:P,onKeydown:H,onKeyup:K},h)}}const Ve=te({name:"QToggle",props:{...ke,icon:String,iconColor:String},emits:ye,setup(s){function t(e,c){const i=u(()=>(e.value===!0?s.checkedIcon:c.value===!0?s.indeterminateIcon:s.uncheckedIcon)||s.icon),r=u(()=>e.value===!0?s.iconColor:null);return()=>[b("div",{class:"q-toggle__track"}),b("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},i.value!==void 0?[b(ae,{name:i.value,color:r.value})]:void 0)]}return xe("toggle",t)}}),we=oe("comics",()=>{const s=g(null),t=g(null),e=g(!1),c=g(1),i=g(0),r=g(5),d=g("");async function x(){if(!s.value){d.value="";try{let o;return e.value?o=await q.getAllDraftedComics(r.value):o=await q.getAllComics(r.value),s.value=o.data.data,t.value=o.data.meta.links,i.value=o.data.meta.last_page,{success:!0,data:o.data}}catch(o){return d.value=o.userMessage,{success:!1,error:o}}}}async function p(){if(t.value!==null){let o;const l=t.value[c.value];typeof l<"u"&&l!==null&&(e.value?o=await q.getPageDraftedComics(l.url):o=await q.getPage(l.url),i.value=o.data.meta.last_page,s.value=o.data.data,t.value=o.data.meta.links)}}return{comics:s,links:t,errorMessage:d,showDrafted:e,currentPage:c,pagesCount:i,perPage:r,getComics:x,getPage:p}}),Ce={class:"comics-list q-my-lg"},qe={class:"toolbar"},Se={class:"paginator bg-dark shadow-4"},Ie={key:0,class:"draft bg-dark q-px-md q-py-xs shadow-4"},Pe={key:0,class:"column content-center q-gutter-lg"},Qe=["onClick"],De={class:"col q-pa-md"},$e={class:"row full-height"},Be={class:"col-3 column justify-between items-center text-center q-pr-md"},Ae={class:"q-my-none"},Oe={class:"q-my-none"},Fe={class:"q-my-none text-subtitle1 text-grey"},Te={class:"col-8 row items-center"},je={class:"q-my-none q-mx-lg text-body1"},Ee={key:1,class:"column content-center q-gutter-lg"},Re={class:"col q-pa-md"},Ue={class:"row full-height"},Ne={class:"col-3 column justify-between items-center text-center q-pr-md"},ze={class:"col-9"},Le={class:"toolbar"},Me={class:"paginator bg-dark"},He=se({__name:"HomePage",setup(s){const t=we(),e=ge(),c=de(),i=re(),r=()=>c.user?.role=="writer"||c.user?.role=="admin",d=async p=>{e.comicId=p,await i.push({name:"comic",params:{comicId:p}})},x=async()=>{t.comics=null,await t.getComics()};return le(async()=>{t.showDrafted=!1,t.comics=null,await t.getComics()}),(p,o)=>(_(),ne(pe,{class:"full-width column content-center bg-primary"},{default:Q(()=>[n("div",Ce,[n("div",qe,[n("div",Se,[f(A,{modelValue:m(t).currentPage,"onUpdate:modelValue":[o[0]||(o[0]=l=>m(t).currentPage=l),m(t).getPage],max:m(t).pagesCount,input:"",color:"white","input-class":"text-white"},null,8,["modelValue","onUpdate:modelValue","max"])]),r()?(_(),y("div",Ie,[o[3]||(o[3]=n("span",null,"Показать черновики",-1)),f(Ve,{modelValue:m(t).showDrafted,"onUpdate:modelValue":[o[1]||(o[1]=l=>m(t).showDrafted=l),x],color:"blue"},null,8,["modelValue"])])):ue("",!0)]),n("div",null,[m(t).comics?(_(),y("div",Pe,[(_(!0),y(T,null,j(m(t).comics,l=>(_(),y("div",{key:l.id,class:"comic-item shadow-4",onClick:D=>d(l.id)},[f(O,{class:"comic-card text-white"},{default:Q(()=>[f(ve,{src:l.cover_image,class:"comic-image",ratio:3/4},null,8,["src"]),n("div",De,[n("div",$e,[n("div",Be,[n("h6",Ae,C(l.title),1),n("h5",Oe,C(l.rating),1),n("h4",Fe,C(l.type),1)]),f(J,{dark:"",vertical:""}),n("div",Te,[n("p",je,C(l.description),1)])])])]),_:2},1024)],8,Qe))),128))])):(_(),y("div",Ee,[(_(),y(T,null,j(5,l=>n("div",{key:l,class:"comic-item full-width shadow-4"},[f(O,{class:"comic-card"},{default:Q(()=>[f(w,{type:"rect"}),n("div",Re,[n("div",Ue,[n("div",Ne,[f(w,{class:"q-my-none",type:"text"}),f(w,{class:"q-my-none text-subtitle1",type:"text"})]),n("div",ze,[f(w,{class:"q-my-none q-my-none text-body1",type:"text"})])])])]),_:1})])),64))]))]),n("div",Le,[n("div",Me,[f(A,{modelValue:m(t).currentPage,"onUpdate:modelValue":[o[2]||(o[2]=l=>m(t).currentPage=l),m(t).getPage],max:m(t).pagesCount,input:"",color:"white","input-class":"text-white"},null,8,["modelValue","onUpdate:modelValue","max"])])])])]),_:1}))}}),ot=he(He,[["__scopeId","data-v-ad9b2fc9"]]);export{ot as default};
