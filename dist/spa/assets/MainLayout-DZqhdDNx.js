import{k as $,h as v,c,l as F,n as ee,g as R,r as z,m as ae,w,o as G,Q as le,p as T,q as ie,a as K,t as V,u as O,v as J,x as re,y as te,z as ue,A as ne,B as oe,C as se,D as ce,E as D,b as de,d as fe,G as L,H as S,I as P,f as q,J as Y,K as I,L as ve,M,N as he,O as me}from"./index-BASOLPem.js";import{Q as ge,a as E,b as N}from"./QMenu-B8MewD-f.js";import{u as be,s as we,g as ye,a as Se,b as Be,c as j,Q as W}from"./focusout-B5i7jXWr.js";import{Q as k,a as qe,C as U}from"./ClosePopup-0zHzVb_B.js";import{u as Ce,a as xe}from"./authStore-BuVcws2a.js";import"./use-timeout-ARCC4Yza.js";import"./axios-DGCM4XXZ.js";const ze=$({name:"QSpace",setup(){const e=v("div",{class:"q-space"});return()=>e}}),pe=$({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:s}){const o=c(()=>{const a=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(t=>e[t]===!0).map(t=>`q-btn-group--${t}`).join(" ");return`q-btn-group row no-wrap${a.length!==0?" "+a:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>v("div",{class:o.value},F(s.default))}}),Qe=Object.keys(ee);function _e(e){return Qe.reduce((s,o)=>{const a=e[o];return a!==void 0&&(s[o]=a),s},{})}const He=$({name:"QBtnDropdown",props:{...ee,...be,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,noRefocus:Boolean,noFocus:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:s,emit:o}){const{proxy:a}=R(),t=z(e.modelValue),u=z(null),r=Ce(),m=c(()=>{const n={"aria-expanded":t.value===!0?"true":"false","aria-haspopup":"true","aria-controls":r.value,"aria-label":e.toggleAriaLabel||a.$q.lang.label[t.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(n["aria-disabled"]="true"),n}),g=c(()=>"q-btn-dropdown__arrow"+(t.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),f=c(()=>ae(e)),C=c(()=>_e(e));w(()=>e.modelValue,n=>{u.value?.[n?"show":"hide"]()}),w(()=>e.split,b);function x(n){t.value=!0,o("beforeShow",n)}function p(n){o("show",n),o("update:modelValue",!0)}function d(n){t.value=!1,o("beforeHide",n)}function B(n){o("hide",n),o("update:modelValue",!1)}function y(n){o("click",n)}function Q(n){ie(n),b(),o("click",n)}function H(n){u.value?.toggle(n)}function i(n){u.value?.show(n)}function b(n){u.value?.hide(n)}return Object.assign(a,{show:i,hide:b,toggle:H}),G(()=>{e.modelValue===!0&&i()}),()=>{const n=[v(le,{class:g.value,name:e.dropdownIcon||a.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&n.push(v(ge,{ref:u,id:r.value,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noEscDismiss:e.noEscDismiss,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,noFocus:e.noFocus,noRefocus:e.noRefocus,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:x,onShow:p,onBeforeHide:d,onHide:B},s.default)),e.split===!1?v(T,{class:"q-btn-dropdown q-btn-dropdown--simple",...C.value,...m.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:y},{default:()=>F(s.label,[]).concat(n),loading:s.loading}):v(pe,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square,...f.value,glossy:e.glossy,stretch:e.stretch},()=>[v(T,{class:"q-btn-dropdown--current",...C.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:Q},{default:s.label,loading:s.loading}),v(T,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...m.value,...f.value,disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple},()=>n)])}}}),Ve=$({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:s}){const o=c(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>v("div",{class:o.value,role:"toolbar"},F(s.default))}}),$e=$({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:s,emit:o}){const{proxy:{$q:a}}=R(),t=K(O,V);if(t===V)return console.error("QHeader needs to be child of QLayout"),V;const u=z(parseInt(e.heightHint,10)),r=z(!0),m=c(()=>e.reveal===!0||t.view.value.indexOf("H")!==-1||a.platform.is.ios&&t.isContainer.value===!0),g=c(()=>{if(e.modelValue!==!0)return 0;if(m.value===!0)return r.value===!0?u.value:0;const i=u.value-t.scroll.value.position;return i>0?i:0}),f=c(()=>e.modelValue!==!0||m.value===!0&&r.value!==!0),C=c(()=>e.modelValue===!0&&f.value===!0&&e.reveal===!0),x=c(()=>"q-header q-layout__section--marginal "+(m.value===!0?"fixed":"absolute")+"-top"+(e.bordered===!0?" q-header--bordered":"")+(f.value===!0?" q-header--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus":"")),p=c(()=>{const i=t.rows.value.top,b={};return i[0]==="l"&&t.left.space===!0&&(b[a.lang.rtl===!0?"right":"left"]=`${t.left.size}px`),i[2]==="r"&&t.right.space===!0&&(b[a.lang.rtl===!0?"left":"right"]=`${t.right.size}px`),b});function d(i,b){t.update("header",i,b)}function B(i,b){i.value!==b&&(i.value=b)}function y({height:i}){B(u,i),d("size",i)}function Q(i){C.value===!0&&B(r,!0),o("focusin",i)}w(()=>e.modelValue,i=>{d("space",i),B(r,!0),t.animate()}),w(g,i=>{d("offset",i)}),w(()=>e.reveal,i=>{i===!1&&B(r,e.modelValue)}),w(r,i=>{t.animate(),o("reveal",i)}),w(t.scroll,i=>{e.reveal===!0&&B(r,i.direction==="up"||i.position<=e.revealOffset||i.position-i.inflectionPoint<100)});const H={};return t.instances.header=H,e.modelValue===!0&&d("size",u.value),d("space",e.modelValue),d("offset",g.value),J(()=>{t.instances.header===H&&(t.instances.header=void 0,d("size",0),d("offset",0),d("space",!1))}),()=>{const i=re(s.default,[]);return e.elevated===!0&&i.push(v("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),i.push(v(k,{debounce:0,onResize:y})),v("header",{class:x.value,style:p.value,onFocusin:Q},i)}}}),Le=$({name:"QPageContainer",setup(e,{slots:s}){const{proxy:{$q:o}}=R(),a=K(O,V);if(a===V)return console.error("QPageContainer needs to be child of QLayout"),V;te(ue,!0);const t=c(()=>{const u={};return a.header.space===!0&&(u.paddingTop=`${a.header.size}px`),a.right.space===!0&&(u[`padding${o.lang.rtl===!0?"Left":"Right"}`]=`${a.right.size}px`),a.footer.space===!0&&(u.paddingBottom=`${a.footer.size}px`),a.left.space===!0&&(u[`padding${o.lang.rtl===!0?"Right":"Left"}`]=`${a.left.size}px`),u});return()=>v("div",{class:"q-page-container",style:t.value},F(s.default))}}),Pe=$({name:"QFooter",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:s,emit:o}){const{proxy:{$q:a}}=R(),t=K(O,V);if(t===V)return console.error("QFooter needs to be child of QLayout"),V;const u=z(parseInt(e.heightHint,10)),r=z(!0),m=z(ne.value===!0||t.isContainer.value===!0?0:window.innerHeight),g=c(()=>e.reveal===!0||t.view.value.indexOf("F")!==-1||a.platform.is.ios&&t.isContainer.value===!0),f=c(()=>t.isContainer.value===!0?t.containerHeight.value:m.value),C=c(()=>{if(e.modelValue!==!0)return 0;if(g.value===!0)return r.value===!0?u.value:0;const l=t.scroll.value.position+f.value+u.value-t.height.value;return l>0?l:0}),x=c(()=>e.modelValue!==!0||g.value===!0&&r.value!==!0),p=c(()=>e.modelValue===!0&&x.value===!0&&e.reveal===!0),d=c(()=>"q-footer q-layout__section--marginal "+(g.value===!0?"fixed":"absolute")+"-bottom"+(e.bordered===!0?" q-footer--bordered":"")+(x.value===!0?" q-footer--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus"+(g.value!==!0?" hidden":""):"")),B=c(()=>{const l=t.rows.value.bottom,h={};return l[0]==="l"&&t.left.space===!0&&(h[a.lang.rtl===!0?"right":"left"]=`${t.left.size}px`),l[2]==="r"&&t.right.space===!0&&(h[a.lang.rtl===!0?"left":"right"]=`${t.right.size}px`),h});function y(l,h){t.update("footer",l,h)}function Q(l,h){l.value!==h&&(l.value=h)}function H({height:l}){Q(u,l),y("size",l)}function i(){if(e.reveal!==!0)return;const{direction:l,position:h,inflectionPoint:_}=t.scroll.value;Q(r,l==="up"||h-_<100||t.height.value-f.value-h-u.value<300)}function b(l){p.value===!0&&Q(r,!0),o("focusin",l)}w(()=>e.modelValue,l=>{y("space",l),Q(r,!0),t.animate()}),w(C,l=>{y("offset",l)}),w(()=>e.reveal,l=>{l===!1&&Q(r,e.modelValue)}),w(r,l=>{t.animate(),o("reveal",l)}),w([u,t.scroll,t.height],i),w(()=>a.screen.height,l=>{t.isContainer.value!==!0&&Q(m,l)});const n={};return t.instances.footer=n,e.modelValue===!0&&y("size",u.value),y("space",e.modelValue),y("offset",C.value),J(()=>{t.instances.footer===n&&(t.instances.footer=void 0,y("size",0),y("offset",0),y("space",!1))}),()=>{const l=oe(s.default,[v(k,{debounce:0,onResize:H})]);return e.elevated===!0&&l.push(v("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),v("footer",{class:d.value,style:B.value,onFocusin:b},l)}}}),{passive:Z}=se,Re=["both","horizontal","vertical"],Te=$({name:"QScrollObserver",props:{axis:{type:String,validator:e=>Re.includes(e),default:"vertical"},debounce:[String,Number],scrollTarget:we},emits:["scroll"],setup(e,{emit:s}){const o={position:{top:0,left:0},direction:"down",directionChanged:!1,delta:{top:0,left:0},inflectionPoint:{top:0,left:0}};let a=null,t,u;w(()=>e.scrollTarget,()=>{g(),m()});function r(){a?.();const x=Math.max(0,Se(t)),p=Be(t),d={top:x-o.position.top,left:p-o.position.left};if(e.axis==="vertical"&&d.top===0||e.axis==="horizontal"&&d.left===0)return;const B=Math.abs(d.top)>=Math.abs(d.left)?d.top<0?"up":"down":d.left<0?"left":"right";o.position={top:x,left:p},o.directionChanged=o.direction!==B,o.delta=d,o.directionChanged===!0&&(o.direction=B,o.inflectionPoint=o.position),s("scroll",{...o})}function m(){t=ye(u,e.scrollTarget),t.addEventListener("scroll",f,Z),f(!0)}function g(){t!==void 0&&(t.removeEventListener("scroll",f,Z),t=void 0)}function f(x){if(x===!0||e.debounce===0||e.debounce==="0")r();else if(a===null){const[p,d]=e.debounce?[setTimeout(r,e.debounce),clearTimeout]:[requestAnimationFrame(r),cancelAnimationFrame];a=()=>{d(p),a=null}}}const{proxy:C}=R();return w(()=>C.$q.lang.rtl,r),G(()=>{u=C.$el.parentNode,m()}),J(()=>{a?.(),g()}),Object.assign(C,{trigger:f,getPosition:()=>o}),ce}}),De=$({name:"QLayout",props:{container:Boolean,view:{type:String,default:"hhh lpr fff",validator:e=>/^(h|l)h(h|r) lpr (f|l)f(f|r)$/.test(e.toLowerCase())},onScroll:Function,onScrollHeight:Function,onResize:Function},setup(e,{slots:s,emit:o}){const{proxy:{$q:a}}=R(),t=z(null),u=z(a.screen.height),r=z(e.container===!0?0:a.screen.width),m=z({position:0,direction:"down",inflectionPoint:0}),g=z(0),f=z(ne.value===!0?0:j()),C=c(()=>"q-layout q-layout--"+(e.container===!0?"containerized":"standard")),x=c(()=>e.container===!1?{minHeight:a.screen.height+"px"}:null),p=c(()=>f.value!==0?{[a.lang.rtl===!0?"left":"right"]:`${f.value}px`}:null),d=c(()=>f.value!==0?{[a.lang.rtl===!0?"right":"left"]:0,[a.lang.rtl===!0?"left":"right"]:`-${f.value}px`,width:`calc(100% + ${f.value}px)`}:null);function B(n){if(e.container===!0||document.qScrollPrevented!==!0){const l={position:n.position.top,direction:n.direction,directionChanged:n.directionChanged,inflectionPoint:n.inflectionPoint.top,delta:n.delta.top};m.value=l,e.onScroll!==void 0&&o("scroll",l)}}function y(n){const{height:l,width:h}=n;let _=!1;u.value!==l&&(_=!0,u.value=l,e.onScrollHeight!==void 0&&o("scrollHeight",l),H()),r.value!==h&&(_=!0,r.value=h),_===!0&&e.onResize!==void 0&&o("resize",n)}function Q({height:n}){g.value!==n&&(g.value=n,H())}function H(){if(e.container===!0){const n=u.value>g.value?j():0;f.value!==n&&(f.value=n)}}let i=null;const b={instances:{},view:c(()=>e.view),isContainer:c(()=>e.container),rootRef:t,height:u,containerHeight:g,scrollbarWidth:f,totalWidth:c(()=>r.value+f.value),rows:c(()=>{const n=e.view.toLowerCase().split(" ");return{top:n[0].split(""),middle:n[1].split(""),bottom:n[2].split("")}}),header:D({size:0,offset:0,space:!1}),right:D({size:300,offset:0,space:!1}),footer:D({size:0,offset:0,space:!1}),left:D({size:300,offset:0,space:!1}),scroll:m,animate(){i!==null?clearTimeout(i):document.body.classList.add("q-body--layout-animate"),i=setTimeout(()=>{i=null,document.body.classList.remove("q-body--layout-animate")},155)},update(n,l,h){b[n][l]=h}};if(te(O,b),j()>0){let n=function(){_=null,A.classList.remove("hide-scrollbar")},l=function(){if(_===null){if(A.scrollHeight>a.screen.height)return;A.classList.add("hide-scrollbar")}else clearTimeout(_);_=setTimeout(n,300)},h=function(X){_!==null&&X==="remove"&&(clearTimeout(_),n()),window[`${X}EventListener`]("resize",l)},_=null;const A=document.body;w(()=>e.container!==!0?"add":"remove",h),e.container!==!0&&h("add"),de(()=>{h("remove")})}return()=>{const n=oe(s.default,[v(Te,{onScroll:B}),v(k,{onResize:y})]),l=v("div",{class:C.value,style:x.value,ref:e.container===!0?void 0:t,tabindex:-1},n);return e.container===!0?v("div",{class:"q-layout-container overflow-hidden",ref:t},[v(k,{onResize:Q}),v("div",{class:"absolute-full",style:p.value},[v("div",{class:"scroll",style:d.value},[l])])]):l}}}),Ne=fe({__name:"MainLayout",setup(e){const s=xe(),o=me(),a=async()=>{await s.logout(),o.currentRoute.value.name=="home"?o.go(0):await o.push({name:"home"})},t=()=>s.user?.role=="writer"||s.user?.role=="admin";return G(async()=>{s.token!=null&&await s.getUser()}),(u,r)=>{const m=he("router-view");return P(),L(De,{view:"hHh lpr fFf"},{default:S(()=>[q($e,null,{default:S(()=>[q(Ve,{class:"bg-primary text-white shadow-2"},{default:S(()=>[q(T,{to:{name:"home"},stretch:"",flat:"",label:"Главная"}),q(ze),Y(s).user?(P(),L(He,{key:0,stretch:"",flat:"",label:Y(s).user?.name},{default:S(()=>[q(qe,null,{default:S(()=>[I((P(),L(W,{to:{name:"user"},clickable:""},{default:S(()=>[q(E,null,{default:S(()=>[q(N,null,{default:S(()=>[...r[0]||(r[0]=[M("Профиль",-1)])]),_:1})]),_:1})]),_:1})),[[U]]),t()?I((P(),L(W,{key:0,to:{name:"adding-comics"},clickable:""},{default:S(()=>[q(E,null,{default:S(()=>[q(N,null,{default:S(()=>[...r[1]||(r[1]=[M("Добавить новый комикс",-1)])]),_:1})]),_:1})]),_:1})),[[U]]):ve("",!0),I((P(),L(W,{onClick:a,clickable:""},{default:S(()=>[q(E,null,{default:S(()=>[q(N,null,{default:S(()=>[...r[2]||(r[2]=[M("Выйти из системы",-1)])]),_:1})]),_:1})]),_:1})),[[U]])]),_:1})]),_:1},8,["label"])):(P(),L(T,{key:1,to:{name:"auth"},stretch:"",flat:"",label:"Войти"}))]),_:1})]),_:1}),q(Le,{class:"column justify-start items-center"},{default:S(()=>[q(m)]),_:1}),q(Pe)]),_:1})}}});export{Ne as default};
